<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexa Solar Power Solutions - Calculadora Solar Fotovoltaica</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Enhanced header with company branding -->
        <header class="header">
            <div class="header-content">
                <div class="company-logo">
                    <div class="logo-icon">
                        <i class="fas fa-solar-panel"></i>
                        <div class="logo-accent"></div>
                    </div>
                    <div class="company-info">
                        <h1>Hexa Solar Power Solution</h1>
                        <p class="company-tagline">Energía Solar Inteligente para un Futuro Sostenible</p>
                    </div>
                </div>
                <div class="header-subtitle">
                    <h2>Calculadora Solar Fotovoltaica</h2>
                    <!-- <p>Sistema avanzado de cálculo para instalaciones solares comerciales y residenciales</p> -->
                </div>
            </div>
        </header>
      
        <div class="main-content">
            <div class="form-section">
                <div class="card">
                    <h2><i class="fas fa-user-tie"></i> Datos del cliente</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nombreCliente">Nombre del Cliente:</label>
                            <input type="text" id="nombreCliente" placeholder="Ingrese nombre del cliente">
                        </div>
                        
                        <div class="form-group">
                            <label for="nombreEjecutivo">Ejecutivo de Ventas:</label>
                            <input type="text" id="nombreEjecutivo" placeholder="Ingrese su nombre">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-chart-line"></i> Datos de Consumo Energético</h2>
                    <div class="form-group">
                        <label for="tipoPeriodo">Tipo de Período de Facturación:</label>
                        <select id="tipoPeriodo" onchange="updateConsumoFields()">
                            <option value="mensual">Mensual (12 valores)</option>
                            <option value="bimestral">Bimestral (6 valores)</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Consumo Histórico (kWh):</label>
                        <div id="consumoInputs" class="consumo-grid">
                            Se generará dinámicamente
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-map-marker-alt"></i> Ubicación Geográfica</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="latitud">Latitud:</label>
                            <input type="number" id="latitud" step="0.000001" placeholder="20.676667" value="20.676667">
                        </div>
                        <div class="form-group">
                            <label for="longitud">Longitud:</label>
                            <input type="number" id="longitud" step="0.000001" placeholder="-99.1332" value="-99.1332">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-solar-panel"></i> Especificaciones del Panel Solar</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="potenciaPanel">Potencia Nominal (W):</label>
                            <input type="number" id="potenciaPanel" placeholder="565" value="565">
                        </div>
                        <div class="form-group">
                            <label for="anchoPanel">Ancho (cm):</label>
                            <input type="number" id="anchoPanel" placeholder="113.4" value="113.4">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="altoPanel">Alto (cm):</label>
                            <input type="number" id="altoPanel" placeholder="227.8" value="227.8">
                        </div>
                        <div class="form-group">
                            <label for="pesoPanel">Peso (kg):</label>
                            <input type="number" id="pesoPanel" placeholder="28" value="28">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h2><i class="fas fa-cogs"></i> Configuración del Sistema</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="eficiencia">Eficiencia del Sistema:</label>
                            <input type="number" id="eficiencia" step="0.01" min="0" max="1" placeholder="0.76" value="0.76">
                        </div>
                        <div class="form-group">
                            <label for="porcentajeAhorro">% de Ahorro Requerido:</label>
                            <input type="number" id="porcentajeAhorro" placeholder="100" value="100">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="limitacionEspacio">
                            <span class="checkmark"></span>
                            Limitación de Espacio Disponible
                        </label>
                    </div>

                    <div class="form-group" id="areaGroup">
                        <label for="areaDisponible">Área Disponible (m²):</label>
                        <input type="number" id="areaDisponible" placeholder="40" value="40">
                    </div>

                    <div class="form-group">
                        <label for="pesoEstructura">Peso de Estructura por Módulo (kg):</label>
                        <input type="number" id="pesoEstructura" placeholder="20" value="20">
                    </div>
                </div>

                <button class="calculate-btn" onclick="calcularSistema()">
                    <i class="fas fa-calculator"></i>
                    <span>Calcular Sistema Solar</span>
                </button>
            </div>

            <div class="results-section" id="resultsSection" style="display: none;">
                <div class="card results-card">
                    <!-- Enhanced results header with company branding -->
                    <div class="results-header">
                        <div class="results-title">
                            <i class="fas fa-chart-bar"></i>
                            <h2>Resultados del Análisis Solar</h2>
                        </div>
                        <div class="hexa-badge">
                            <i class="fas fa-solar-panel"></i>
                            <span>Hexa Solar</span>
                        </div>
                    </div>

                    <div class="results-grid">
                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-bolt"></i></div>
                            <div class="result-content">
                                <h3>Consumo Anual</h3>
                                <p id="consumoAnual">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-calendar-day"></i></div>
                            <div class="result-content">
                                <h3>Consumo Diario</h3>
                                <p id="consumoDiario">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-calendar-alt"></i></div>
                            <div class="result-content">
                                <h3>Consumo Mensual</h3>
                                <p id="consumoMensual">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-chart-bar"></i></div>
                            <div class="result-content">
                                <h3>Promedio Mensual</h3>
                                <p id="promedioConsumo">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-sun"></i></div>
                            <div class="result-content">
                                <h3>Horas Solares Pico</h3>
                                <p id="hsp">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-lightning-bolt"></i></div>
                            <div class="result-content">
                                <h3>Potencia Fotovoltaica</h3>
                                <p id="potenciaFotovoltaica">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-solar-panel"></i></div>
                            <div class="result-content">
                                <h3>Número de Módulos</h3>
                                <p id="numeroModulos">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-plug"></i></div>
                            <div class="result-content">
                                <h3>Potencia Instalada</h3>
                                <p id="potenciaInstalada">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-expand-arrows-alt"></i></div>
                            <div class="result-content">
                                <h3>Área Requerida</h3>
                                <p id="areaRequerida">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-industry"></i></div>
                            <div class="result-content">
                                <h3>Generación Anual</h3>
                                <p id="generacionAnual">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-weight-hanging"></i></div>
                            <div class="result-content">
                                <h3>Peso Total Paneles</h3>
                                <p id="pesoTotalPaneles">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-balance-scale"></i></div>
                            <div class="result-content">
                                <h3>Peso por m²</h3>
                                <p id="pesoPorM2">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-weight"></i></div>
                            <div class="result-content">
                                <h3>Peso Total Sistema</h3>
                                <p id="pesoTotalSistema">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-microchip"></i></div>
                            <div class="result-content">
                                <h3>Inversores Recomendados</h3>
                                <p id="numeroInversores">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-leaf"></i></div>
                            <div class="result-content">
                                <h3>Ahorro CO₂</h3>
                                <p id="ahorroCO2">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-tree"></i></div>
                            <div class="result-content">
                                <h3>Árboles Equivalentes</h3>
                                <p id="arbolesPlantados">-</p>
                            </div>
                        </div>

                        <div class="result-item">
                            <div class="result-icon"><i class="fas fa-chart-line"></i></div>
                            <div class="result-content">
                                <h3>Producción Promedio</h3>
                                <p id="promedioProduccion">-</p>
                            </div>
                        </div>
                    </div>

                    <!-- Enhanced table with better styling -->
                    <div class="card table-card">
                        <h2><i class="fas fa-table"></i> Análisis Mensual Detallado</h2>
                        <div class="table-container">
                            <table class="results-table">
                                <thead>
                                    <tr>
                                        <th>Mes</th>
                                        <th>Irradiación (kWh/m²/día)</th>
                                        <th>Producción (kWh)</th>
                                        <th>Consumo (kWh)</th>
                                        <th>Balance (kWh)</th>
                                    </tr>
                                </thead>
                                <tbody id="detalleTableBody">
                                    <!-- Las filas se insertarán dinámicamente aquí -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Enhanced export button -->
                    <div class="export-section">
                        <button class="export-btn" onclick="exportResultsToPdf()">
                            <i class="fas fa-file-pdf"></i>
                            <span>Exportar Reporte Profesional</span>
                        </button>
                        <p class="export-note">Genera un reporte PDF completo con todos los cálculos y análisis</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced loading screen -->
        <div class="loading" id="loading" style="display: none;">
            <div class="loading-content">
                <div class="loading-spinner">
                    <i class="fas fa-solar-panel fa-spin"></i>
                </div>
                <h3>Procesando Datos Solares</h3>
                <p>Consultando datos de irradiación solar de NASA...</p>
                <div class="loading-bar">
                    <div class="loading-progress"></div>
                </div>
            </div>
        </div>

        <!-- Added footer with company info -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-solar-panel"></i>
                    <span>Hexa Solar Power Solutions</span>
                </div>
                <div class="footer-info">
                    <p>© 2024 Hexa Solar Power Solutions. Todos los derechos reservados.</p>
                    <p>Energía Solar Profesional | Soluciones Sostenibles | Tecnología Avanzada</p>
                </div>
            </div>
        </footer>
    </div>

    <script src="script.js"></script>
</body>

</html>
